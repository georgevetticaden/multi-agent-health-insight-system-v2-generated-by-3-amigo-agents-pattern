<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CMO Agent Evaluation Report</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom right, #0f172a, #1e3a8a, #581c87);
      min-height: 100vh;
      color: #e5e7eb;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    .container {
      padding: 32px;
    }
    h1, h2, h3, h4 {
      color: white;
      margin: 0 0 16px 0;
    }
    a {
      color: #60a5fa;
      text-decoration: none;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      color: #e5e7eb;
    }
    th {
      text-align: left;
      padding: 12px;
    }
    td {
      padding: 12px;
    }
    
    /* Collapsible sections */
    .collapsible {
      cursor: pointer;
      user-select: none;
      transition: all 0.3s ease;
    }
    .collapsible:hover {
      background: rgba(255,255,255,0.08);
    }
    .collapsible-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
    }
    .collapsible-arrow {
      transition: transform 0.3s ease;
      font-size: 1.2rem;
    }
    .collapsible-arrow.open {
      transform: rotate(180deg);
    }
    .collapsible-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }
    .collapsible-content.open {
      max-height: 3000px;
    }
    
    /* Failure analysis styling */
    .failure-card {
      background: linear-gradient(135deg, rgba(239,68,68,0.15), rgba(239,68,68,0.05));
      border: 2px solid rgba(239,68,68,0.3);
      border-radius: 16px;
      padding: 24px;
      margin-top: 24px;
      position: relative;
      overflow: hidden;
    }
    .failure-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #ef4444, #dc2626, #ef4444);
      animation: pulse 2s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 1; }
    }
    .failure-header {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }
    .failure-icon {
      background: linear-gradient(135deg, #ef4444, #dc2626);
      width: 48px;
      height: 48px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 4px 12px rgba(239,68,68,0.3);
    }
    .failure-item {
      background: rgba(0,0,0,0.2);
      border-left: 4px solid #ef4444;
      padding: 16px;
      margin-bottom: 12px;
      border-radius: 8px;
    }
    .recommendation-box {
      background: rgba(59,130,246,0.1);
      border: 1px solid rgba(59,130,246,0.3);
      border-radius: 12px;
      padding: 16px;
      margin-top: 16px;
    }
    .progress-bar {
      background: rgba(255,255,255,0.1);
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }
    .progress-fill {
      height: 100%;
      transition: width 0.3s ease;
    }
    .progress-target {
      position: absolute;
      top: -2px;
      bottom: -2px;
      width: 2px;
      background: #60a5fa;
    }
    .test-card {
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      margin-bottom: 24px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .test-card-header {
      background: linear-gradient(135deg, rgba(59,130,246,0.3), rgba(6,182,212,0.3));
      padding: 20px 24px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
  </style>
</head>
<body>
<div class="container">

<h1 style="font-size: 48px; margin-bottom: 16px;">üìä CMO Agent Evaluation Report</h1>
<div style="background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(168,85,247,0.1)); border: 1px solid rgba(59,130,246,0.3); border-radius: 12px; padding: 16px; margin-bottom: 24px;">
  <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
    <strong style="color: #60a5fa;">üèóÔ∏è Multi-Agent Architecture:</strong> This evaluation framework follows Anthropic's best practices for testing multi-agent systems, 
    with the CMO agent serving as the orchestrator that delegates to specialist agents - mirroring the "research lead" pattern described in 
    <a href="https://www.anthropic.com/engineering/built-multi-agent-research-system" style="color: #a78bfa;">"Building Multi-Agent Research Systems"</a>.
  </p>
</div>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding: 24px; border-radius: 16px; margin-bottom: 24px; border: 1px solid rgba(255,255,255,0.1);">
  <div style="font-size: 1.125rem; font-weight: 600; color: #60a5fa;">Test Suite: Real World</div>
  
  <div style="font-size: 0.875rem; color: #e5e7eb; font-style: italic; margin-top: 4px;">Production-grade test cases derived from actual user queries and clinical scenarios</div>
  
</div>


<div style="color: #e5e7eb; margin-bottom: 24px;">
The Real World test suite evaluates the CMO Agent's performance on queries taken from production usage, representing the complexity and nuance of actual medical questions. These tests validate the agent's ability to handle real clinical scenarios with appropriate medical reasoning, specialist selection, and comprehensive analysis.
</div>


<div style="display: flex; gap: 16px; margin: 20px 0;">
  <div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding: 8px 16px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(255,255,255,0.1); color: white;">
    <strong style="color: #60a5fa;">Date:</strong> 2025-06-29T06:48:51
  </div>
  <div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding: 8px 16px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(255,255,255,0.1); color: white;">
    <strong style="color: #60a5fa;">Evaluation Type:</strong> Hybrid (Deterministic + LLM Judge)
  </div>
</div>

<hr style="border: 0; height: 1px; background: rgba(255,255,255,0.1); margin: 32px 0;">

<h2 style="color: white; display: flex; align-items: center; gap: 12px;">
  <span style="background: rgba(59,130,246,0.2); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üî¨</span>
  Evaluation Methodology
</h2>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 16px; padding: 24px; margin-bottom: 32px; border: 1px solid rgba(255,255,255,0.1);">
  <h3 style="color: white; margin: 0 0 16px 0;">üéØ Five Dimensions of CMO Agent Performance</h3>
  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">
    <div style="background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.3); border-radius: 12px; padding: 16px;">
      <h4 style="color: #60a5fa; margin: 0 0 8px 0;">1. Complexity Classification</h4>
      <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
        Evaluates if the CMO correctly identifies query complexity (SIMPLE ‚Üí COMPREHENSIVE).
        <br><span style="color: #94a3b8;">Method: Hybrid (rule-based + LLM verification)</span>
      </p>
    </div>
    
    <div style="background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.3); border-radius: 12px; padding: 16px;">
      <h4 style="color: #a78bfa; margin: 0 0 8px 0;">2. Specialist Selection</h4>
      <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
        Measures precision and recall of selecting appropriate medical specialists.
        <br><span style="color: #94a3b8;">Method: LLM Judge with semantic similarity</span>
      </p>
    </div>
    
    <div style="background: rgba(236,72,153,0.1); border: 1px solid rgba(236,72,153,0.3); border-radius: 12px; padding: 16px;">
      <h4 style="color: #ec4899; margin: 0 0 8px 0;">3. Analysis Quality</h4>
      <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
        Assesses comprehensiveness of the orchestration plan and task delegation.
        <br><span style="color: #94a3b8;">Method: LLM Judge scoring on 5 components</span>
      </p>
    </div>
    
    <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 12px; padding: 16px;">
      <h4 style="color: #10b981; margin: 0 0 8px 0;">4. Tool Usage</h4>
      <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
        Validates effective use of health data query tools for initial assessment.
        <br><span style="color: #94a3b8;">Method: Deterministic validation</span>
      </p>
    </div>
    
    <div style="background: rgba(251,191,36,0.1); border: 1px solid rgba(251,191,36,0.3); border-radius: 12px; padding: 16px;">
      <h4 style="color: #fbbf24; margin: 0 0 8px 0;">5. Response Structure</h4>
      <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
        Ensures compliance with required XML format for downstream processing.
        <br><span style="color: #94a3b8;">Method: Deterministic XML validation</span>
      </p>
    </div>
  </div>
  
  <div style="margin-top: 20px; padding: 16px; background: rgba(96,165,250,0.1); border: 1px solid rgba(96,165,250,0.3); border-radius: 12px;">
    <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
      <strong style="color: #60a5fa;">üìö Based on Anthropic's Testing Best Practices:</strong> This evaluation framework implements the hybrid approach recommended in Anthropic's 
      <a href="https://www.anthropic.com/engineering/built-multi-agent-research-system" style="color: #a78bfa;">testing guidelines</a>, combining:
    </p>
    <ul style="margin: 8px 0 0 20px; color: #e5e7eb; font-size: 0.875rem;">
      <li><strong>Deterministic checks</strong> for objective criteria (tool usage, XML structure)</li>
      <li><strong>LLM Judges</strong> for subjective quality assessment (analysis comprehensiveness, specialist selection appropriateness)</li>
      <li><strong>Semantic similarity</strong> for flexibility in specialist naming (e.g., "primary_care" ‚âà "general_practice")</li>
    </ul>
  </div>
</div>

<h2 style="color: white; display: flex; align-items: center; gap: 12px;">
  <span style="background: rgba(59,130,246,0.2); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üéØ</span>
  Executive Summary
</h2>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 16px; padding: 24px; margin-bottom: 24px; border: 1px solid rgba(255,255,255,0.1);">
  <h3 style="display: flex; align-items: center; gap: 8px; margin: 0 0 16px 0; color: white;">
    <span style="font-size: 1.5rem;">üî¥</span>
    CMO Agent Test Suite: <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; margin-left: 8px;">FAIL</span>
  </h3>
  
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-top: 20px;">
    <div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding: 16px; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
      <div style="font-size: 0.875rem; color: #94a3b8; margin-bottom: 4px;">Overall Score</div>
      <div style="font-size: 2rem; font-weight: 700; color: white;">75.0%</div>
    </div>
    <div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding: 16px; border-radius: 12px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
      <div style="font-size: 0.875rem; color: #94a3b8; margin-bottom: 4px;">Test Cases Evaluated</div>
      <div style="font-size: 2rem; font-weight: 700; color: white;">4</div>
    </div>
  </div>
  
  
</div>

<h3 style="color: white;">Test Case Summary</h3>
<div style="font-size: 0.875rem; color: #94a3b8; font-style: italic; margin-bottom: 12px;">
  Individual test results with dimension failures
  <span style="display: inline-block; margin-left: 12px; background: rgba(59,130,246,0.1); padding: 4px 12px; border-radius: 12px; border: 1px solid rgba(59,130,246,0.3);">
    <strong>‚ÑπÔ∏è Note:</strong> Tests PASS only when ALL evaluation dimensions meet their target thresholds
  </span>
</div>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); margin-bottom: 24px; border: 1px solid rgba(255,255,255,0.1);">
  <table style="width: 100%; border-collapse: collapse; color: white;">
    <thead>
      <tr style="background: linear-gradient(135deg, #3b82f6, #06b6d4);">
        <th style="color: white; padding: 12px 16px; text-align: left;">Test Case</th>
        <th style="color: white; padding: 12px 16px; text-align: left;">Status</th>
        <th style="color: white; padding: 12px 16px; text-align: left;">Failed Dimensions</th>
        <th style="color: white; padding: 12px 16px; text-align: left;">Complexity</th>
      </tr>
    </thead>
    <tbody>
      
      <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
        <td style="padding: 12px 16px; color: #e5e7eb;">standard_001</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px; font-size: 0.875rem;">‚ùå FAIL</span>
        </td>
        <td style="padding: 12px 16px; color: #e5e7eb;">Specialists, Quality</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(59,130,246,0.2); color: #93bbfc; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">STANDARD</span>
        </td>
      </tr>
      
      <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
        <td style="padding: 12px 16px; color: #e5e7eb;">standard_002</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px; font-size: 0.875rem;">‚ùå FAIL</span>
        </td>
        <td style="padding: 12px 16px; color: #e5e7eb;">Specialists, Quality</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(59,130,246,0.2); color: #93bbfc; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">STANDARD</span>
        </td>
      </tr>
      
      <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
        <td style="padding: 12px 16px; color: #e5e7eb;">complex_001</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px; font-size: 0.875rem;">‚ùå FAIL</span>
        </td>
        <td style="padding: 12px 16px; color: #e5e7eb;">Specialists, Quality</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(168,85,247,0.2); color: #d8b4fe; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">COMPLEX</span>
        </td>
      </tr>
      
      <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
        <td style="padding: 12px 16px; color: #e5e7eb;">complex_002</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px; font-size: 0.875rem;">‚ùå FAIL</span>
        </td>
        <td style="padding: 12px 16px; color: #e5e7eb;">Complexity, Quality</td>
        <td style="padding: 12px 16px;">
          <span style="background: rgba(168,85,247,0.2); color: #d8b4fe; padding: 4px 8px; border-radius: 4px; font-size: 0.75rem;">COMPLEX</span>
        </td>
      </tr>
      
      <tr style="background: linear-gradient(135deg, rgba(59,130,246,0.2), rgba(168,85,247,0.2)); font-weight: 600;">
        <td style="padding: 12px 16px; color: white;">TOTAL</td>
        <td style="padding: 12px 16px; color: white;">0/4 Passed</td>
        <td style="padding: 12px 16px; color: white;">4 tests with failures</td>
        <td style="padding: 12px 16px; color: white;">-</td>
      </tr>
    </tbody>
  </table>
</div>

<h3 style="color: white;">Dimension Performance Across All Tests</h3>
<div style="font-size: 0.875rem; color: #94a3b8; font-style: italic; margin-bottom: 12px;">
  Average scores across all test cases for each evaluation dimension
  <span style="display: inline-block; margin-left: 12px; background: rgba(168,85,247,0.1); padding: 4px 12px; border-radius: 12px; border: 1px solid rgba(168,85,247,0.3);">
    <strong>üéØ Anthropic Best Practice:</strong> Hybrid evaluation using both deterministic checks and LLM judges
  </span>
</div>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 12px; padding: 24px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); margin-bottom: 24px; border: 1px solid rgba(255,255,255,0.1);">
  
  <div style="margin-bottom: 20px;">
    <div style="font-weight: 600; color: #e5e7eb; margin-bottom: 4px;">Complexity Classification</div>
    <div style="display: flex; justify-content: space-between; margin: 8px 0;">
      <span style="color: #cbd5e1;">Score: <strong style="color: #ef4444;">75.0%</strong></span>
      <span style="color: #cbd5e1;">Target: 90.0%</span>
    </div>
    <div class="progress-bar">
      <div style="width: 75.0%; height: 100%; background: linear-gradient(to right, #ef4444, #dc2626);"></div>
      <div class="progress-target" style="left: 90.0%;"></div>
    </div>
    <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 4px;">üîÑ Hybrid ‚Ä¢ Accuracy of query complexity classification</div>
  </div>
  
  <div style="margin-bottom: 20px;">
    <div style="font-weight: 600; color: #e5e7eb; margin-bottom: 4px;">Specialty Selection</div>
    <div style="display: flex; justify-content: space-between; margin: 8px 0;">
      <span style="color: #cbd5e1;">Score: <strong style="color: #ef4444;">62.5%</strong></span>
      <span style="color: #cbd5e1;">Target: 85.0%</span>
    </div>
    <div class="progress-bar">
      <div style="width: 62.5%; height: 100%; background: linear-gradient(to right, #ef4444, #dc2626);"></div>
      <div class="progress-target" style="left: 85.0%;"></div>
    </div>
    <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 4px;">üß† LLM Judge ‚Ä¢ Precision in selecting appropriate medical specialists</div>
  </div>
  
  <div style="margin-bottom: 20px;">
    <div style="font-weight: 600; color: #e5e7eb; margin-bottom: 4px;">Analysis Quality</div>
    <div style="display: flex; justify-content: space-between; margin: 8px 0;">
      <span style="color: #cbd5e1;">Score: <strong style="color: #ef4444;">76.0%</strong></span>
      <span style="color: #cbd5e1;">Target: 80.0%</span>
    </div>
    <div class="progress-bar">
      <div style="width: 76.0%; height: 100%; background: linear-gradient(to right, #ef4444, #dc2626);"></div>
      <div class="progress-target" style="left: 80.0%;"></div>
    </div>
    <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 4px;">üß† LLM Judge ‚Ä¢ Comprehensiveness of medical analysis</div>
  </div>
  
  <div style="margin-bottom: 20px;">
    <div style="font-weight: 600; color: #e5e7eb; margin-bottom: 4px;">Tool Usage</div>
    <div style="display: flex; justify-content: space-between; margin: 8px 0;">
      <span style="color: #cbd5e1;">Score: <strong style="color: #10b981;">100.0%</strong></span>
      <span style="color: #cbd5e1;">Target: 90.0%</span>
    </div>
    <div class="progress-bar">
      <div style="width: 100.0%; height: 100%; background: linear-gradient(to right, #10b981, #059669);"></div>
      <div class="progress-target" style="left: 90.0%;"></div>
    </div>
    <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 4px;">üîß Deterministic ‚Ä¢ Effectiveness of tool calls</div>
  </div>
  
  <div style="margin-bottom: 20px;">
    <div style="font-weight: 600; color: #e5e7eb; margin-bottom: 4px;">Response Structure</div>
    <div style="display: flex; justify-content: space-between; margin: 8px 0;">
      <span style="color: #cbd5e1;">Score: <strong style="color: #10b981;">100.0%</strong></span>
      <span style="color: #cbd5e1;">Target: 95.0%</span>
    </div>
    <div class="progress-bar">
      <div style="width: 100.0%; height: 100%; background: linear-gradient(to right, #10b981, #059669);"></div>
      <div class="progress-target" style="left: 95.0%;"></div>
    </div>
    <div style="font-size: 0.75rem; color: #94a3b8; margin-top: 4px;">üîß Deterministic ‚Ä¢ Compliance with XML format</div>
  </div>
  
  
  
  <div style="background: rgba(239,68,68,0.1); padding: 16px; border-radius: 8px; margin-top: 20px; border: 1px solid rgba(239,68,68,0.2);">
    <strong style="color: #fca5a5;">Dimension Failure Details:</strong>
    <ul style="margin-top: 8px; color: #e5e7eb;">
      
      <li><strong>Complexity Classification:</strong> 1 of 4 tests failed (25%)</li>
      
      <li><strong>Specialty Selection:</strong> 3 of 4 tests failed (75%)</li>
      
      <li><strong>Analysis Quality:</strong> 4 of 4 tests failed (100%)</li>
      
    </ul>
  </div>
  
</div>


<h2 style="color: white; display: flex; align-items: center; gap: 12px;">
  <span style="background: rgba(59,130,246,0.2); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üîç</span>
  Failure Patterns & Common Issues
</h2>

<div style="background: linear-gradient(135deg, rgba(236,72,153,0.1), rgba(168,85,247,0.1)); border: 1px solid rgba(168,85,247,0.3); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
  <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
    <strong style="color: #a78bfa;">üìä Pattern Analysis Insight:</strong> As described in Anthropic's 
    <a href="https://www.anthropic.com/engineering/built-multi-agent-research-system" style="color: #ec4899;">multi-agent systems blog</a>, 
    identifying failure patterns helps refine the orchestrator's decision-making. Common issues often stem from:
  </p>
  <ul style="margin: 8px 0 0 20px; color: #e5e7eb; font-size: 0.875rem;">
    <li>Overly complex interpretations of simple queries (over-orchestration)</li>
    <li>Missing domain experts for comprehensive analysis</li>
    <li>Insufficient task decomposition for specialists</li>
  </ul>
</div>


<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; margin-bottom: 16px;">
  <h3 style="color: #60a5fa; margin: 0 0 12px 0;">Complexity Classification Issues</h3>
  <p style="margin: 0 0 8px 0; color: #e5e7eb;">Found 1 test(s) with misclassified complexity.</p>
  
  <div style="background: rgba(59,130,246,0.1); padding: 12px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(59,130,246,0.1);">
    <strong style="color: #60a5fa;">Common Pattern:</strong> <span style="color: #e5e7eb;">The CMO is over-analyzing straightforward requests by adding unnecessary clinical interpretation and specialist requirements.</span>
  </div>
  
</div>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; margin-bottom: 16px;">
  <h3 style="color: #60a5fa; margin: 0 0 12px 0;">Analysis Quality Issues</h3>
  <p style="margin: 0 0 8px 0; color: #e5e7eb;">Found 4 test(s) below quality threshold.</p>
  
  <div style="background: rgba(59,130,246,0.1); padding: 12px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(59,130,246,0.1);">
    <strong style="color: #60a5fa;">Common Pattern:</strong> <span style="color: #e5e7eb;">Comprehensive Approach component failing due to missed key medical concepts and keywords.</span>
  </div>
  
</div>


<div style="background: rgba(59,130,246,0.1); padding: 16px; border-radius: 8px; margin-top: 16px; border: 1px solid rgba(59,130,246,0.2);">
  <p style="margin: 0; font-size: 0.875rem; color: #e5e7eb;">
    üí° <strong style="color: #60a5fa;">Note:</strong> Detailed analysis for each test is available in the Test Results section below.
  </p>
</div>


<h2 style="color: white; display: flex; align-items: center; gap: 12px;">
  <span style="background: rgba(59,130,246,0.2); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üìã</span>
  Test Results Detail
</h2>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); padding: 16px; border-radius: 8px; margin-bottom: 24px; border: 1px solid rgba(255,255,255,0.1);">
  <strong style="color: #60a5fa;">üìù CMO Agent Prompts Being Tested:</strong>
  <p style="margin: 8px 0; color: #94a3b8; font-size: 0.875rem;">
    The CMO agent uses a multi-stage prompting approach to orchestrate the analysis:
  </p>
  <ul style="margin-top: 8px; color: #e5e7eb;">
    
    <li style="margin-bottom: 8px;">
      <a href="../../../services/agents/cmo/prompts/1_initial_analysis.txt" style="color: #60a5fa; text-decoration: none;">
        <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px;">1_initial_analysis.txt</code>
      </a> - Analyzes query complexity
      
        <span style="color: #94a3b8; font-size: 0.875rem;">(LLM Judge target for: complexity misclassification, some quality issues)</span>
      
    </li>
    
    <li style="margin-bottom: 8px;">
      <a href="../../../services/agents/cmo/prompts/2_initial_analysis_summarize.txt" style="color: #60a5fa; text-decoration: none;">
        <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px;">2_initial_analysis_summarize.txt</code>
      </a> - Summarizes findings
      
    </li>
    
    <li style="margin-bottom: 8px;">
      <a href="../../../services/agents/cmo/prompts/3_task_creation.txt" style="color: #60a5fa; text-decoration: none;">
        <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 4px;">3_task_creation.txt</code>
      </a> - Creates specialist tasks
      
        <span style="color: #94a3b8; font-size: 0.875rem;">(LLM Judge target for: specialist selection, task delegation issues)</span>
      
    </li>
    
  </ul>
</div>

<hr style="border: 0; height: 1px; background: rgba(255,255,255,0.1); margin: 32px 0;">


<h2 style="color: white;">Test Case: standard_001 ‚ùå</h2>

<div class="test-card">
  <div class="test-card-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <h3 style="margin: 0; color: white; font-size: 1.25rem;">Test Case: standard_001</h3>
      <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">FAILED</span>
    </div>
  </div>
  
  <div style="padding: 24px;">
    <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.1);">
      <strong style="color: #60a5fa;">Health Query:</strong>
      <p style="margin: 8px 0 0 0; color: #e5e7eb;">What's my cholesterol trend over my entire data? I want to see trends across the top 4 cholesterol metrics including Triglycerides across that time period</p>
    </div>
    
    <!-- Collapsible Health Query Response -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Health Query Response/Analysis</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px; background: rgba(0,0,0,0.3); color: #e5e7eb; font-size: 0.875rem; line-height: 1.6;">
          <pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">To analyze this patient's cholesterol trends over time, we should take the following approach:

Specialists needed:
- Primary Care Physician: To oversee the analysis and provide general health context
- Cardiologist: To assess cardiovascular risk factors and interpret cholesterol trends

Key data points to investigate:
- Total Cholesterol, HDL, LDL, Triglycerides levels over time 
- Dates and frequency of cholesterol tests
- Average, minimum, and maximum values for each metric

Potential correlations to explore:
- Changes in cholesterol levels correlated with any medication changes
- Relationship between HDL/LDL ratio and overall cardiovascular health
- Impact of lifestyle factors like diet and exercise on cholesterol trends

Immediate concerns:
- The initial data shows some high Triglyceride readings in 2013-2014 (up to 426 mg/dL)
- Need to see if Triglycerides improved in later years or remain a concern
- Average and maximum LDL levels appear slightly elevated, which warrants further investigation

Overall, the patient has cholesterol data spanning 2013 to 2025, providing a good longitudinal dataset to analyze trends. The key will be plotting the 4 main metrics over time, looking for any significant changes, and correlating those with medication, lifestyle and health factors. The high Triglycerides in early years and elevated LDL deserve attention to assess cardiovascular risk.</pre>
        </div>
      </div>
    </div>
    
    
    <div style="display: flex; gap: 16px; margin: 16px 0;">
      <div style="background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(255,255,255,0.1);">
        <strong style="color: #60a5fa;">Response Time:</strong> <span style="color: #e5e7eb;">61.0s</span>
      </div>
    </div>
    
    
    <h4 style="color: #e5e7eb;">Evaluation Summary</h4>
    
    <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden; margin: 16px 0;">
      <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
        <thead>
          <tr style="background: rgba(255,255,255,0.1);">
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Dimension</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Expected</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Actual</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Score</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Target</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Status</th>
          </tr>
        </thead>
        <tbody>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Complexity Classification</td>
            <td style="padding: 12px; ">STANDARD</td>
            <td style="padding: 12px; ">STANDARD</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Specialist Selection</td>
            <td style="padding: 12px; font-size: 0.875rem;">cardiology, data_analysis, endocrinology</td>
            <td style="padding: 12px; font-size: 0.875rem;">cardiology, laboratory_medicine, pharmacy</td>
            <td style="padding: 12px;">0.20</td>
            <td style="padding: 12px;">0.85</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Analysis Quality</td>
            <td style="padding: 12px; ">‚â•0.80</td>
            <td style="padding: 12px; ">0.76</td>
            <td style="padding: 12px;">0.76</td>
            <td style="padding: 12px;">0.80</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Tool Usage</td>
            <td style="padding: 12px; ">Effective</td>
            <td style="padding: 12px; ">1 calls</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Response Structure</td>
            <td style="padding: 12px; ">Valid XML</td>
            <td style="padding: 12px; ">Valid</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.95</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
        </tbody>
      </table>
    </div>

    
    <!-- Collapsible Analysis Quality Score Breakdown -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Analysis Quality Score Breakdown</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px;">
          <p style="margin: 0 0 16px 0; color: #e5e7eb;">This breakdown shows how the Analysis Quality score was calculated:</p>
          
          <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
              <thead>
                <tr style="background: rgba(255,255,255,0.1);">
                  <th style="padding: 12px; text-align: left;">Component</th>
                  <th style="padding: 12px; text-align: left;">Weight</th>
                  <th style="padding: 12px; text-align: left;">Score</th>
                  <th style="padding: 12px; text-align: left;">Weighted</th>
                  <th style="padding: 12px; text-align: left;">What We Looked For</th>
                </tr>
              </thead>
              <tbody>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Data Gathering</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">1.00</td>
                  <td style="padding: 12px;">0.200</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Made appropriate tool calls to gather health data</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Context Awareness</td>
                  <td style="padding: 12px;">0.15</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.105</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Mentioned dates, timeframes, or temporal context</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Specialist Rationale</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Clear reasoning provided for specialist selection</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Comprehensive Approach</td>
                  <td style="padding: 12px;">0.25</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.175</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Coverage of expected medical concepts and keywords</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Concern Identification</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Identified specific health concerns or risks</td>
                </tr>
                
                <tr style="background: rgba(59,130,246,0.1); font-weight: 600;">
                  <td style="padding: 12px; color: white;">Total</td>
                  <td style="padding: 12px; color: white;">1.00</td>
                  <td style="padding: 12px; color: white;">-</td>
                  <td style="padding: 12px; color: white;">0.760</td>
                  <td style="padding: 12px; color: white;">Target: ‚â• 0.800</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    

    
    <!-- Enhanced Failure Analysis Section -->
    <div class="failure-card">
      <div class="failure-header">
        <div class="failure-icon">üî¨</div>
        <h4 style="color: white; margin: 0; font-size: 1.25rem;">LLM Judge Failure Analysis</h4>
      </div>
      
      <div style="background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.3); border-radius: 12px; padding: 12px; margin: 0 0 16px 0;">
        <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
          <strong style="color: #a78bfa;">üîç Analysis Method:</strong> Following Anthropic's testing best practices, we use an LLM Judge to analyze failures and provide 
          specific, actionable recommendations for prompt improvements. This goes beyond simple metric checking to understand <em>why</em> the agent failed and <em>how</em> to fix it.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600; font-size: 1.1rem;">
          üìä Analysis Quality Issue
        </p>
        <p style="margin: 0; color: #e5e7eb;">
          The CMO agent did not provide thorough enough task decomposition and delegation to the specialist agents to ensure a comprehensive analysis
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600;">
          üîç Root Cause Analysis
        </p>
        <p style="margin: 0; color: #e5e7eb; font-size: 0.9rem;">
          While the CMO identified the key specialists and data points, it did not break down the analysis into specific tasks and responsibilities for each specialist
        </p>
      </div>
      
      
      
      <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
        
        <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 600;">HIGH PRIORITY</span>
        
        
        <code style="background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem;">backend/services/agents/cmo/prompts/3_task_creation.txt</code>
        
      </div>
      
      
      
      <div class="recommendation-box">
        <p style="margin: 0 0 12px 0; color: #60a5fa; font-weight: 600;">
          üí° Recommended Prompt Changes
        </p>
        <ul style="margin: 0; padding-left: 20px; color: #e5e7eb;">
          
          <li style="margin-bottom: 8px;">Add instruction in prompt: 'Define clear responsibilities and deliverables for each specialist agent'</li>
          
          <li style="margin-bottom: 8px;">Modify section in prompt: 'Provide a detailed task breakdown, specifying what analysis each specialist should perform'</li>
          
        </ul>
      </div>
      
      
      
      <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 12px; padding: 16px; margin-top: 16px;">
        <p style="margin: 0; color: #6ee7b7; font-weight: 600;">
          üìà Expected Impact
        </p>
        <p style="margin: 8px 0 0 0; color: #e5e7eb; font-size: 0.9rem;">
          With a more granular task decomposition, the specialist agents will have clear guidance on their roles, leading to a more thorough and well-coordinated analysis. This should improve the overall comprehensiveness and quality of the final output.
        </p>
      </div>
      
      
    </div>
    
  </div>
</div>

<hr style="border: 0; height: 1px; background: rgba(255,255,255,0.1); margin: 32px 0;">

<h2 style="color: white;">Test Case: standard_002 ‚ùå</h2>

<div class="test-card">
  <div class="test-card-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <h3 style="margin: 0; color: white; font-size: 1.25rem;">Test Case: standard_002</h3>
      <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">FAILED</span>
    </div>
  </div>
  
  <div style="padding: 24px;">
    <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.1);">
      <strong style="color: #60a5fa;">Health Query:</strong>
      <p style="margin: 8px 0 0 0; color: #e5e7eb;">Show my abnormal lab results from labs this year?</p>
    </div>
    
    <!-- Collapsible Health Query Response -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Health Query Response/Analysis</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px; background: rgba(0,0,0,0.3); color: #e5e7eb; font-size: 0.875rem; line-height: 1.6;">
          <pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">Based on the initial lab results data from 2025, analyzing the patient's abnormal lab values this year should be a relatively straightforward task that can be handled by an internal medicine physician or primary care doctor. No additional medical specialties are needed at this point.

Key data points to investigate:
- Blood Urea Nitrogen (BUN) of 23.0 mg/dL is slightly elevated above the normal range of 6-20 mg/dL. While not extremely high, this warrants monitoring kidney function and hydration status.
- HbA1c of 6.1% is above the normal range of 4-5.6%, indicating pre-diabetes or diabetes. The patient's glucose control over the past ~3 months should be evaluated.

Potential correlations to explore:
- Elevated BUN and HbA1c levels could potentially indicate early stages of diabetic kidney disease, although more data points would be needed to assess this. Recommend checking urinalysis for protein/albumin and following up on blood sugar control.
- Renal function and electrolytes like sodium, potassium, chloride are currently normal but should continue to be monitored along with BUN and creatinine given slight BUN elevation.

Immediate concerns:
- No critical lab values that are of immediate concern. However, HbA1c indicates chronic hyperglycemia that should be addressed to prevent progression to diabetes and complications.
- Recommend lifestyle counseling on diet, exercise, and weight management to improve blood sugar control. May need to consider starting metformin if HbA1c remains elevated.

In summary, an internal medicine workup focusing on blood sugar control, kidney function, and metabolic status should be sufficient to address this patient's abnormal lab results from 2025 based on the data so far. Preventing progression of pre-diabetes is the key concern.</pre>
        </div>
      </div>
    </div>
    
    
    <div style="display: flex; gap: 16px; margin: 16px 0;">
      <div style="background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(255,255,255,0.1);">
        <strong style="color: #60a5fa;">Response Time:</strong> <span style="color: #e5e7eb;">54.8s</span>
      </div>
    </div>
    
    
    <h4 style="color: #e5e7eb;">Evaluation Summary</h4>
    
    <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden; margin: 16px 0;">
      <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
        <thead>
          <tr style="background: rgba(255,255,255,0.1);">
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Dimension</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Expected</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Actual</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Score</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Target</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Status</th>
          </tr>
        </thead>
        <tbody>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Complexity Classification</td>
            <td style="padding: 12px; ">STANDARD</td>
            <td style="padding: 12px; ">STANDARD</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Specialist Selection</td>
            <td style="padding: 12px; font-size: 0.875rem;">endocrinology, laboratory_medicine, preventive_medicine</td>
            <td style="padding: 12px; font-size: 0.875rem;">endocrinology, general_practice, laboratory_medicine</td>
            <td style="padding: 12px;">0.50</td>
            <td style="padding: 12px;">0.85</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Analysis Quality</td>
            <td style="padding: 12px; ">‚â•0.80</td>
            <td style="padding: 12px; ">0.76</td>
            <td style="padding: 12px;">0.76</td>
            <td style="padding: 12px;">0.80</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Tool Usage</td>
            <td style="padding: 12px; ">Effective</td>
            <td style="padding: 12px; ">1 calls</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Response Structure</td>
            <td style="padding: 12px; ">Valid XML</td>
            <td style="padding: 12px; ">Valid</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.95</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
        </tbody>
      </table>
    </div>

    
    <!-- Collapsible Analysis Quality Score Breakdown -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Analysis Quality Score Breakdown</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px;">
          <p style="margin: 0 0 16px 0; color: #e5e7eb;">This breakdown shows how the Analysis Quality score was calculated:</p>
          
          <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
              <thead>
                <tr style="background: rgba(255,255,255,0.1);">
                  <th style="padding: 12px; text-align: left;">Component</th>
                  <th style="padding: 12px; text-align: left;">Weight</th>
                  <th style="padding: 12px; text-align: left;">Score</th>
                  <th style="padding: 12px; text-align: left;">Weighted</th>
                  <th style="padding: 12px; text-align: left;">What We Looked For</th>
                </tr>
              </thead>
              <tbody>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Data Gathering</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">1.00</td>
                  <td style="padding: 12px;">0.200</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Made appropriate tool calls to gather health data</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Context Awareness</td>
                  <td style="padding: 12px;">0.15</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.105</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Mentioned dates, timeframes, or temporal context</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Specialist Rationale</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Clear reasoning provided for specialist selection</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Comprehensive Approach</td>
                  <td style="padding: 12px;">0.25</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.175</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Coverage of expected medical concepts and keywords</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Concern Identification</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Identified specific health concerns or risks</td>
                </tr>
                
                <tr style="background: rgba(59,130,246,0.1); font-weight: 600;">
                  <td style="padding: 12px; color: white;">Total</td>
                  <td style="padding: 12px; color: white;">1.00</td>
                  <td style="padding: 12px; color: white;">-</td>
                  <td style="padding: 12px; color: white;">0.760</td>
                  <td style="padding: 12px; color: white;">Target: ‚â• 0.800</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    

    
    <!-- Enhanced Failure Analysis Section -->
    <div class="failure-card">
      <div class="failure-header">
        <div class="failure-icon">üî¨</div>
        <h4 style="color: white; margin: 0; font-size: 1.25rem;">LLM Judge Failure Analysis</h4>
      </div>
      
      <div style="background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.3); border-radius: 12px; padding: 12px; margin: 0 0 16px 0;">
        <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
          <strong style="color: #a78bfa;">üîç Analysis Method:</strong> Following Anthropic's testing best practices, we use an LLM Judge to analyze failures and provide 
          specific, actionable recommendations for prompt improvements. This goes beyond simple metric checking to understand <em>why</em> the agent failed and <em>how</em> to fix it.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600; font-size: 1.1rem;">
          üìä Analysis Quality Issue
        </p>
        <p style="margin: 0; color: #e5e7eb;">
          The CMO agent did not delegate tasks comprehensively enough to cover all aspects of the abnormal lab results analysis.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600;">
          üîç Root Cause Analysis
        </p>
        <p style="margin: 0; color: #e5e7eb; font-size: 0.9rem;">
          The task planning focused primarily on the high HbA1c and pre-diabetes aspect, but did not adequately break down tasks for specialists to investigate the elevated BUN and potential kidney function implications.
        </p>
      </div>
      
      
      
      <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
        
        <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 600;">HIGH PRIORITY</span>
        
        
        <code style="background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem;">backend/services/agents/cmo/prompts/3_task_creation.txt</code>
        
      </div>
      
      
      
      <div class="recommendation-box">
        <p style="margin: 0 0 12px 0; color: #60a5fa; font-weight: 600;">
          üí° Recommended Prompt Changes
        </p>
        <ul style="margin: 0; padding-left: 20px; color: #e5e7eb;">
          
          <li style="margin-bottom: 8px;">Add instruction in prompt: 'Ensure abnormal lab values across all organ systems are accounted for in specialist task delegation'</li>
          
          <li style="margin-bottom: 8px;">Modify section in prompt: 'Provide guidance on breaking down tasks for each abnormal lab value and potential comorbidities that require multi-specialty input'</li>
          
        </ul>
      </div>
      
      
      
      <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 12px; padding: 16px; margin-top: 16px;">
        <p style="margin: 0; color: #6ee7b7; font-weight: 600;">
          üìà Expected Impact
        </p>
        <p style="margin: 8px 0 0 0; color: #e5e7eb; font-size: 0.9rem;">
          With these improvements, the CMO will create more comprehensive task plans that delegate appropriate workup for all abnormal lab findings to the relevant specialist agents. This will enhance overall orchestration effectiveness and ensure no key aspects are missed during the specialist evaluation phase.
        </p>
      </div>
      
      
    </div>
    
  </div>
</div>

<hr style="border: 0; height: 1px; background: rgba(255,255,255,0.1); margin: 32px 0;">

<h2 style="color: white;">Test Case: complex_001 ‚ùå</h2>

<div class="test-card">
  <div class="test-card-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <h3 style="margin: 0; color: white; font-size: 1.25rem;">Test Case: complex_001</h3>
      <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">FAILED</span>
    </div>
  </div>
  
  <div style="padding: 24px;">
    <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.1);">
      <strong style="color: #60a5fa;">Health Query:</strong>
      <p style="margin: 8px 0 0 0; color: #e5e7eb;">Analyze cholesterol relevant medication adherence patterns over that time period and how do they correlate with these cholesterol lab results.</p>
    </div>
    
    <!-- Collapsible Health Query Response -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Health Query Response/Analysis</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px; background: rgba(0,0,0,0.3); color: #e5e7eb; font-size: 0.875rem; line-height: 1.6;">
          <pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">Based on the initial data gathering, this query requires a complex analysis involving medication adherence patterns and correlation with cholesterol lab results over time. The key medical specialties and approach needed:

Specialties:
- Cardiology: To assess cardiovascular risk factors and interpret cholesterol results 
- Clinical Pharmacology: To analyze medication adherence patterns and dosing

Key data points:
- Dates, dosages, and frequencies of cholesterol medications prescribed (rosuvastatin, ezetimibe, atorvastatin) 
- Dates and values of total cholesterol, LDL, and HDL lab results
- Look for any gaps in medication data that could indicate adherence issues

Potential correlations:
- Plot a timeline of medication prescriptions and lab results to visualize trends
- Assess if cholesterol levels improved after starting medications or dose changes
- Analyze if periods of presumed low adherence correlate with worsening lab results
- Determine if combination therapy (rosuvastatin + ezetimibe) had additive benefits

Immediate concerns:
- Patient's HDL has been consistently low and flagged as abnormal which increases cardiac risk
- Frequent changes in cholesterol medications and dosages noted, could indicate suboptimal response or side effects impacting adherence
- No medication data available after 10/2024, but a recent high total cholesterol of 149 in 4/2025, so current med adherence is unclear

In summary, a comprehensive analysis by a cardiologist and pharmacologist is recommended, focused on correlating periods of medication adherence and dosage changes with the impacts on cholesterol lab trends over time, to identify potential opportunities for optimizing this patient's therapeutic regimen and cardiovascular risk reduction.</pre>
        </div>
      </div>
    </div>
    
    
    <div style="display: flex; gap: 16px; margin: 16px 0;">
      <div style="background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(255,255,255,0.1);">
        <strong style="color: #60a5fa;">Response Time:</strong> <span style="color: #e5e7eb;">69.1s</span>
      </div>
    </div>
    
    
    <h4 style="color: #e5e7eb;">Evaluation Summary</h4>
    
    <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden; margin: 16px 0;">
      <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
        <thead>
          <tr style="background: rgba(255,255,255,0.1);">
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Dimension</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Expected</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Actual</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Score</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Target</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Status</th>
          </tr>
        </thead>
        <tbody>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Complexity Classification</td>
            <td style="padding: 12px; ">COMPLEX</td>
            <td style="padding: 12px; ">COMPLEX</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Specialist Selection</td>
            <td style="padding: 12px; font-size: 0.875rem;">cardiology, data_analysis, endocrinology, laboratory_medicine, pharmacy</td>
            <td style="padding: 12px; font-size: 0.875rem;">cardiology, data_analysis, laboratory_medicine, pharmacy</td>
            <td style="padding: 12px;">0.80</td>
            <td style="padding: 12px;">0.85</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Analysis Quality</td>
            <td style="padding: 12px; ">‚â•0.80</td>
            <td style="padding: 12px; ">0.76</td>
            <td style="padding: 12px;">0.76</td>
            <td style="padding: 12px;">0.80</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Tool Usage</td>
            <td style="padding: 12px; ">Effective</td>
            <td style="padding: 12px; ">1 calls</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Response Structure</td>
            <td style="padding: 12px; ">Valid XML</td>
            <td style="padding: 12px; ">Valid</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.95</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
        </tbody>
      </table>
    </div>

    
    <!-- Collapsible Analysis Quality Score Breakdown -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Analysis Quality Score Breakdown</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px;">
          <p style="margin: 0 0 16px 0; color: #e5e7eb;">This breakdown shows how the Analysis Quality score was calculated:</p>
          
          <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
              <thead>
                <tr style="background: rgba(255,255,255,0.1);">
                  <th style="padding: 12px; text-align: left;">Component</th>
                  <th style="padding: 12px; text-align: left;">Weight</th>
                  <th style="padding: 12px; text-align: left;">Score</th>
                  <th style="padding: 12px; text-align: left;">Weighted</th>
                  <th style="padding: 12px; text-align: left;">What We Looked For</th>
                </tr>
              </thead>
              <tbody>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Data Gathering</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">1.00</td>
                  <td style="padding: 12px;">0.200</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Made appropriate tool calls to gather health data</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Context Awareness</td>
                  <td style="padding: 12px;">0.15</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.105</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Mentioned dates, timeframes, or temporal context</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Specialist Rationale</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Clear reasoning provided for specialist selection</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Comprehensive Approach</td>
                  <td style="padding: 12px;">0.25</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.175</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Coverage of expected medical concepts and keywords</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Concern Identification</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Identified specific health concerns or risks</td>
                </tr>
                
                <tr style="background: rgba(59,130,246,0.1); font-weight: 600;">
                  <td style="padding: 12px; color: white;">Total</td>
                  <td style="padding: 12px; color: white;">1.00</td>
                  <td style="padding: 12px; color: white;">-</td>
                  <td style="padding: 12px; color: white;">0.760</td>
                  <td style="padding: 12px; color: white;">Target: ‚â• 0.800</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    

    
    <!-- Enhanced Failure Analysis Section -->
    <div class="failure-card">
      <div class="failure-header">
        <div class="failure-icon">üî¨</div>
        <h4 style="color: white; margin: 0; font-size: 1.25rem;">LLM Judge Failure Analysis</h4>
      </div>
      
      <div style="background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.3); border-radius: 12px; padding: 12px; margin: 0 0 16px 0;">
        <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
          <strong style="color: #a78bfa;">üîç Analysis Method:</strong> Following Anthropic's testing best practices, we use an LLM Judge to analyze failures and provide 
          specific, actionable recommendations for prompt improvements. This goes beyond simple metric checking to understand <em>why</em> the agent failed and <em>how</em> to fix it.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600; font-size: 1.1rem;">
          üìä Analysis Quality Issue
        </p>
        <p style="margin: 0; color: #e5e7eb;">
          The CMO did not fully decompose the task into granular steps for specialists, missing some key data points.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600;">
          üîç Root Cause Analysis
        </p>
        <p style="margin: 0; color: #e5e7eb; font-size: 0.9rem;">
          While the CMO identified the right medical specialties needed, the task delegation lacked comprehensive coverage of all relevant data points that specialists should analyze.
        </p>
      </div>
      
      
      
      <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
        
        <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 600;">HIGH PRIORITY</span>
        
        
        <code style="background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem;">backend/services/agents/cmo/prompts/3_task_creation.txt</code>
        
      </div>
      
      
      
      <div class="recommendation-box">
        <p style="margin: 0 0 12px 0; color: #60a5fa; font-weight: 600;">
          üí° Recommended Prompt Changes
        </p>
        <ul style="margin: 0; padding-left: 20px; color: #e5e7eb;">
          
          <li style="margin-bottom: 8px;">Add instruction in prompt: 'Ensure all key data points mentioned in the query are explicitly delegated to relevant specialists'</li>
          
          <li style="margin-bottom: 8px;">Modify section in prompt: 'Provide more examples of granular task decomposition for different types of medical analyses'</li>
          
        </ul>
      </div>
      
      
      
      <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 12px; padding: 16px; margin-top: 16px;">
        <p style="margin: 0; color: #6ee7b7; font-weight: 600;">
          üìà Expected Impact
        </p>
        <p style="margin: 8px 0 0 0; color: #e5e7eb; font-size: 0.9rem;">
          With more thorough task breakdown and delegation of all relevant data points, the specialists will have clear guidance on the comprehensive analyses required, leading to higher quality outputs.
        </p>
      </div>
      
      
    </div>
    
  </div>
</div>

<hr style="border: 0; height: 1px; background: rgba(255,255,255,0.1); margin: 32px 0;">

<h2 style="color: white;">Test Case: complex_002 ‚ùå</h2>

<div class="test-card">
  <div class="test-card-header">
    <div style="display: flex; justify-content: space-between; align-items: center;">
      <h3 style="margin: 0; color: white; font-size: 1.25rem;">Test Case: complex_002</h3>
      <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-size: 0.875rem; font-weight: 600;">FAILED</span>
    </div>
  </div>
  
  <div style="padding: 24px;">
    <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px; margin-bottom: 16px; border: 1px solid rgba(255,255,255,0.1);">
      <strong style="color: #60a5fa;">Health Query:</strong>
      <p style="margin: 8px 0 0 0; color: #e5e7eb;">How has my HbA1c level changed since I started taking metformin, has my dosage been adjusted over time based on my lab results, and is there a correlation between these changes and my weight measurements during the same period?</p>
    </div>
    
    <!-- Collapsible Health Query Response -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Health Query Response/Analysis</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px; background: rgba(0,0,0,0.3); color: #e5e7eb; font-size: 0.875rem; line-height: 1.6;">
          <pre style="white-space: pre-wrap; margin: 0; font-family: inherit;">To properly analyze the patient's diabetes management and address their question, the following approach is recommended:

Specialties needed:
- Endocrinology: To evaluate diabetes control, medication effectiveness, and make treatment adjustments as needed. An endocrinologist has expertise in managing diabetes and interpreting relevant lab values like HbA1c.

Key data points:
- HbA1c values and dates to assess glycemic control over time
- Metformin prescription dates and dosages to determine medication history  
- Weight measurements and dates to track changes 

Correlations to explore:
- Changes in HbA1c in relation to metformin start date and any dosage adjustments
- Relationship between HbA1c trends and weight changes over the same time period
- Impact of any dosage changes on glycemic control

Immediate concerns:
- Significant weight gain of over 25 lbs noted between March 2024 and April 2025. Need to evaluate potential causes (e.g. lifestyle changes, medication side effects) and impact on diabetes control.
- Only one HbA1c value available in the 18-month timeframe. More frequent monitoring may be indicated to assess diabetes management. Should confirm frequency of HbA1c testing with patient and in medical record.</pre>
        </div>
      </div>
    </div>
    
    
    <div style="display: flex; gap: 16px; margin: 16px 0;">
      <div style="background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 8px; font-size: 0.875rem; border: 1px solid rgba(255,255,255,0.1);">
        <strong style="color: #60a5fa;">Response Time:</strong> <span style="color: #e5e7eb;">59.0s</span>
      </div>
    </div>
    
    
    <h4 style="color: #e5e7eb;">Evaluation Summary</h4>
    
    <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden; margin: 16px 0;">
      <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
        <thead>
          <tr style="background: rgba(255,255,255,0.1);">
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Dimension</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Expected</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Actual</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Score</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Target</th>
            <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Status</th>
          </tr>
        </thead>
        <tbody>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Complexity Classification</td>
            <td style="padding: 12px; ">COMPLEX</td>
            <td style="padding: 12px; ">STANDARD</td>
            <td style="padding: 12px;">0.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Specialist Selection</td>
            <td style="padding: 12px; font-size: 0.875rem;">endocrinology, nutrition, pharmacy</td>
            <td style="padding: 12px; font-size: 0.875rem;">endocrinology, nutrition, pharmacy</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.85</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Analysis Quality</td>
            <td style="padding: 12px; ">‚â•0.80</td>
            <td style="padding: 12px; ">0.76</td>
            <td style="padding: 12px;">0.76</td>
            <td style="padding: 12px;">0.80</td>
            <td style="padding: 12px;">
              <span style="background: rgba(239,68,68,0.2); color: #fca5a5; padding: 4px 8px; border-radius: 4px;">‚ùå FAIL</span>
            </td>
          </tr>
          
          <tr style="background: rgba(255,255,255,0.02);">
            <td style="padding: 12px; font-weight: 600;">Tool Usage</td>
            <td style="padding: 12px; ">Effective</td>
            <td style="padding: 12px; ">1 calls</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.90</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
          <tr >
            <td style="padding: 12px; font-weight: 600;">Response Structure</td>
            <td style="padding: 12px; ">Valid XML</td>
            <td style="padding: 12px; ">Valid</td>
            <td style="padding: 12px;">1.00</td>
            <td style="padding: 12px;">0.95</td>
            <td style="padding: 12px;">
              <span style="background: rgba(16,185,129,0.2); color: #6ee7b7; padding: 4px 8px; border-radius: 4px;">‚úÖ PASS</span>
            </td>
          </tr>
          
        </tbody>
      </table>
    </div>

    
    <!-- Collapsible Analysis Quality Score Breakdown -->
    <div style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; margin-bottom: 16px; overflow: hidden;">
      <div class="collapsible collapsible-header" onclick="toggleSection(this)">
        <strong style="color: #60a5fa;">Analysis Quality Score Breakdown</strong>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        <div style="padding: 16px;">
          <p style="margin: 0 0 16px 0; color: #e5e7eb;">This breakdown shows how the Analysis Quality score was calculated:</p>
          
          <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
              <thead>
                <tr style="background: rgba(255,255,255,0.1);">
                  <th style="padding: 12px; text-align: left;">Component</th>
                  <th style="padding: 12px; text-align: left;">Weight</th>
                  <th style="padding: 12px; text-align: left;">Score</th>
                  <th style="padding: 12px; text-align: left;">Weighted</th>
                  <th style="padding: 12px; text-align: left;">What We Looked For</th>
                </tr>
              </thead>
              <tbody>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Data Gathering</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">1.00</td>
                  <td style="padding: 12px;">0.200</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Made appropriate tool calls to gather health data</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Context Awareness</td>
                  <td style="padding: 12px;">0.15</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.105</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Mentioned dates, timeframes, or temporal context</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Specialist Rationale</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Clear reasoning provided for specialist selection</td>
                </tr>
                
                <tr style="background: rgba(255,255,255,0.02);">
                  <td style="padding: 12px; font-weight: 600;">Comprehensive Approach</td>
                  <td style="padding: 12px;">0.25</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.175</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Coverage of expected medical concepts and keywords</td>
                </tr>
                
                <tr >
                  <td style="padding: 12px; font-weight: 600;">Concern Identification</td>
                  <td style="padding: 12px;">0.20</td>
                  <td style="padding: 12px;">0.70</td>
                  <td style="padding: 12px;">0.140</td>
                  <td style="padding: 12px; font-size: 0.875rem;">Identified specific health concerns or risks</td>
                </tr>
                
                <tr style="background: rgba(59,130,246,0.1); font-weight: 600;">
                  <td style="padding: 12px; color: white;">Total</td>
                  <td style="padding: 12px; color: white;">1.00</td>
                  <td style="padding: 12px; color: white;">-</td>
                  <td style="padding: 12px; color: white;">0.760</td>
                  <td style="padding: 12px; color: white;">Target: ‚â• 0.800</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    

    
    <!-- Enhanced Failure Analysis Section -->
    <div class="failure-card">
      <div class="failure-header">
        <div class="failure-icon">üî¨</div>
        <h4 style="color: white; margin: 0; font-size: 1.25rem;">LLM Judge Failure Analysis</h4>
      </div>
      
      <div style="background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.3); border-radius: 12px; padding: 12px; margin: 0 0 16px 0;">
        <p style="margin: 0; color: #e5e7eb; font-size: 0.875rem;">
          <strong style="color: #a78bfa;">üîç Analysis Method:</strong> Following Anthropic's testing best practices, we use an LLM Judge to analyze failures and provide 
          specific, actionable recommendations for prompt improvements. This goes beyond simple metric checking to understand <em>why</em> the agent failed and <em>how</em> to fix it.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600; font-size: 1.1rem;">
          ‚ö†Ô∏è Complexity Classification Issue
        </p>
        <p style="margin: 0; color: #e5e7eb;">
          The current prompt lacks clear criteria to distinguish between a complex and standard query. It does not provide specific guidance on handling queries involving analysis of trends, correlations, or multiple data points over time.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600;">
          üîç Root Cause Analysis
        </p>
        <p style="margin: 0; color: #e5e7eb; font-size: 0.9rem;">
          By explicitly defining what constitutes a complex query and providing relevant examples, the prompt will be better equipped to accurately classify queries that involve trend analysis, correlation identification, and integration of multiple data points across different time periods. This will help clearly delineate the boundary between standard and complex queries, preventing misclassifications like the one observed.
        </p>
      </div>
      
      
      
      <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
        
        <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 600;">HIGH PRIORITY</span>
        
        
        <code style="background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem;">backend/services/agents/cmo/prompts/1_initial_analysis.txt</code>
        
      </div>
      
      
      
      <div class="recommendation-box">
        <p style="margin: 0 0 12px 0; color: #60a5fa; font-weight: 600;">
          üí° Recommended Prompt Changes
        </p>
        <ul style="margin: 0; padding-left: 20px; color: #e5e7eb;">
          
          <li style="margin-bottom: 8px;">Add a section defining 'complex' queries as those requiring analysis of multiple data points across different time periods, tracking trends, and identifying potential correlations between different medical parameters.</li>
          
          <li style="margin-bottom: 8px;">Provide examples of complex queries, such as tracking changes in lab values in relation to medication adjustments, evaluating the impact of lifestyle factors on disease progression, or analyzing correlations between symptoms and various test results over time.</li>
          
        </ul>
      </div>
      
      
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600; font-size: 1.1rem;">
          üìä Analysis Quality Issue
        </p>
        <p style="margin: 0; color: #e5e7eb;">
          The CMO agent's task delegation and specialist selection was not comprehensive enough to fully address the complexity of the query.
        </p>
      </div>
      
      
      <div class="failure-item">
        <p style="margin: 0 0 8px 0; color: white; font-weight: 600;">
          üîç Root Cause Analysis
        </p>
        <p style="margin: 0; color: #e5e7eb; font-size: 0.9rem;">
          The CMO agent did not identify the need for a nutritionist or lifestyle specialist to evaluate potential causes of weight gain and its impact on diabetes management.
        </p>
      </div>
      
      
      
      <div style="display: flex; align-items: center; gap: 12px; margin: 20px 0;">
        
        <span style="background: linear-gradient(135deg, #ef4444, #dc2626); color: white; padding: 6px 16px; border-radius: 20px; font-weight: 600;">HIGH PRIORITY</span>
        
        
        <code style="background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem;">backend/services/agents/cmo/prompts/3_task_creation.txt</code>
        
      </div>
      
      
      
      <div class="recommendation-box">
        <p style="margin: 0 0 12px 0; color: #60a5fa; font-weight: 600;">
          üí° Recommended Prompt Changes
        </p>
        <ul style="margin: 0; padding-left: 20px; color: #e5e7eb;">
          
          <li style="margin-bottom: 8px;">Add instruction in prompt: 'Consider lifestyle factors and weight management specialists when significant weight changes are involved'</li>
          
          <li style="margin-bottom: 8px;">Modify section in prompt: 'Emphasize the need to investigate root causes behind clinical data trends or abnormalities, not just describing the trends themselves'</li>
          
        </ul>
      </div>
      
      
      
      <div style="background: rgba(16,185,129,0.1); border: 1px solid rgba(16,185,129,0.3); border-radius: 12px; padding: 16px; margin-top: 16px;">
        <p style="margin: 0; color: #6ee7b7; font-weight: 600;">
          üìà Expected Impact
        </p>
        <p style="margin: 8px 0 0 0; color: #e5e7eb; font-size: 0.9rem;">
          With these improvements, the CMO agent will be better equipped to identify a comprehensive set of specialists and delegate tasks for a more holistic analysis, leading to higher orchestration quality scores.
        </p>
      </div>
      
      
    </div>
    
  </div>
</div>

<hr style="border: 0; height: 1px; background: rgba(255,255,255,0.1); margin: 32px 0;">


<h2 style="color: white; display: flex; align-items: center; gap: 12px;">
  <span style="background: rgba(59,130,246,0.2); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">üìä</span>
  Visualizations
</h2>

<h3 style="color: white;">Performance by Dimension</h3>
<div style="font-size: 0.875rem; color: #94a3b8; margin-bottom: 16px;">
The chart below shows how the CMO Agent performs across each evaluation dimension compared to target thresholds:
</div>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 16px; padding: 40px; text-align: center; border: 2px dashed rgba(255,255,255,0.2); margin: 24px 0;">
  <div style="font-size: 3rem; margin-bottom: 16px;">üìä</div>
  <h4 style="color: #60a5fa; margin-bottom: 8px;">Dimension Scores</h4>
  <p style="color: #cbd5e1; font-size: 0.875rem;">Performance across evaluation dimensions vs. target thresholds</p>
  <img src="./dimension_scores.png" alt="Dimension Scores Chart" style="max-width: 100%; height: auto; margin-top: 20px; border-radius: 8px;">
</div>

<h3 style="color: white;">Additional Performance Charts</h3>

<div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border-radius: 12px; padding: 20px; margin-top: 24px; border: 1px solid rgba(255,255,255,0.1);">
  <p style="margin: 0 0 16px 0; color: #60a5fa; font-weight: 600;">Click on any chart below to view additional performance insights:</p>
  
  <div style="background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
    <table style="width: 100%; border-collapse: collapse; color: #e5e7eb;">
      <thead>
        <tr style="background: linear-gradient(135deg, rgba(59,130,246,0.2), rgba(168,85,247,0.2));">
          <th style="padding: 16px; text-align: left; font-weight: 600;">Chart</th>
          <th style="padding: 16px; text-align: left; font-weight: 600;">What It Shows</th>
          <th style="padding: 16px; text-align: left; font-weight: 600;">Key Insights</th>
        </tr>
      </thead>
      <tbody>
        
        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
          <td style="padding: 16px;">
            <a href="./complexity_performance.png" style="color: #60a5fa; text-decoration: none; font-weight: 600;">Complexity Performance</a>
          </td>
          <td style="padding: 16px;">Metrics by query complexity (STANDARD vs COMPLEX)</td>
          <td style="padding: 16px; color: #94a3b8;">See if certain query types perform better</td>
        </tr>
        
        <tr style="background: rgba(255,255,255,0.02); border-bottom: 1px solid rgba(255,255,255,0.1);">
          <td style="padding: 16px;">
            <a href="./response_time_distribution.png" style="color: #60a5fa; text-decoration: none; font-weight: 600;">Response Time Distribution</a>
          </td>
          <td style="padding: 16px;">Histogram of processing times</td>
          <td style="padding: 16px; color: #94a3b8;">Understand performance consistency</td>
        </tr>
        
        <tr style="border-bottom: 1px solid rgba(255,255,255,0.1);">
          <td style="padding: 16px;">
            <a href="./specialty_heatmap.png" style="color: #60a5fa; text-decoration: none; font-weight: 600;">Specialty Heatmap</a>
          </td>
          <td style="padding: 16px;">Which specialists are selected together</td>
          <td style="padding: 16px; color: #94a3b8;">Identify common specialist combinations</td>
        </tr>
        
      </tbody>
    </table>
  </div>
</div>

</div>
</body>
<script>
function toggleSection(element) {
  const content = element.nextElementSibling;
  const arrow = element.querySelector('.collapsible-arrow');
  
  content.classList.toggle('open');
  arrow.classList.toggle('open');
}
</script>
</html>